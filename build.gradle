plugins {
    id 'java'
    id 'application'
    id 'com.gradleup.shadow' version '9.2.2'
}

group = 'joseta'
version = '2.0.0'

sourceSets.main.java.srcDirs = ['src/main/java']
sourceSets.main.resources.srcDirs = ['src/main/resources']

application.mainClass = 'joseta.JosetaBot'
group = 'joseta'
version = '2.0.0'

repositories { mavenCentral() }

dependencies {
    implementation('net.dv8tion:JDA:6.0.0-rc.5') {
    implementation('net.dv8tion:JDA:6.1.0') {
      // Optionally disable audio natives to reduce jar size by excluding `opus-java` and `tink`
      exclude module: 'opus-java'
      exclude module: 'tink'
    }
    implementation 'ch.qos.logback:logback-classic:1.5.19'
    implementation 'io.github.cdimascio:dotenv-java:3.2.0'
    implementation 'org.reflections:reflections:0.10.2'

    implementation 'org.postgresql:postgresql:42.7.8'
    implementation 'org.hibernate:hibernate-core:7.1.2.Final'
    // Hibernate Processor
    annotationProcessor 'org.hibernate.orm:hibernate-processor:7.1.2.Final'
    // Hibernate Validator
    implementation 'org.hibernate.validator:hibernate-validator:9.0.1.Final'
    implementation 'org.glassfish.expressly:expressly:6.0.0'
    // Agroal connection pool
    runtimeOnly 'org.hibernate.orm:hibernate-agroal:7.1.2.Final'
}

tasks.withType(JavaCompile).configureEach {
    options.encoding = 'UTF-8'
    options.incremental = true

    sourceCompatibility = JavaVersion.VERSION_17
    options.compilerArgs << '-parameters'
}

shadowJar {
    mainClass = 'joseta.JosetaBot'
    archiveFileName = 'JosetaBot.jar'
}
